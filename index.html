<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --pixel-size: 4px;
            --color-primary: #6a5acd;
            --color-secondary: #9370db;
            --color-accent: #ffd700;
            --color-bg: #1a1a2e;
        }
        
        * {
            box-sizing: border-box;
            image-rendering: pixelated;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background-color: var(--color-bg);
            color: #fff;
            padding: 10px;
            max-width: 500px;
            margin: 0 auto;
            overflow-x: hidden;
        }
        
        .pixel-border {
            border: 2px solid var(--color-primary);
            position: relative;
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.4);
        }
        
        .pixel-border::before {
            content: "";
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 2px solid var(--color-accent);
            z-index: -1;
        }
        
        h1 {
            text-align: center;
            color: var(--color-accent);
            text-shadow: 2px 2px 0 #000;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        #currency-display {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .currency {
            text-align: center;
            padding: 10px;
        }
        
        .currency-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--color-accent);
        }
        
        #click-area {
            text-align: center;
            margin: 20px 0;
        }
        
        #click-button {
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="%23ffd700"/><circle cx="12" cy="12" r="6" fill="%236a5acd"/></svg>') center/cover;
            border: none;
            cursor: pointer;
            transition: transform 0.1s;
        }
        
        #click-button:active {
            transform: scale(0.95);
        }
        
        .cps-display {
            margin-top: 10px;
            font-size: 14px;
            color: #aaa;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 10px;
        }
        
        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: var(--color-primary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            background: transparent;
            border-bottom: 2px solid var(--color-accent);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .upgrade {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(106, 90, 205, 0.2);
            cursor: pointer;
            border: 1px solid var(--color-secondary);
        }
        
        .upgrade:hover {
            background: rgba(106, 90, 205, 0.4);
        }
        
        .upgrade-info {
            flex: 2;
        }
        
        .upgrade-price {
            flex: 1;
            text-align: right;
            color: var(--color-accent);
            font-weight: bold;
        }
        
        .upgrade-level {
            font-size: 12px;
            color: #aaa;
        }
        
        .generator {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(26, 26, 46, 0.7);
            border: 1px solid var(--color-primary);
        }
        
        .generator-icon {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            background: var(--color-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .generator-info {
            flex: 1;
        }
        
        .generator-name {
            font-weight: bold;
        }
        
        .generator-cps {
            font-size: 12px;
            color: #aaa;
        }
        
        .generator-cost {
            color: var(--color-accent);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="pixel-border">
        <h1>PIXEL CLICKER</h1>
        
        <div id="currency-display">
            <div class="currency">
                <div>–ö–õ–ò–ö–ò</div>
                <div id="clicks-display" class="currency-value">0</div>
            </div>
            <div class="currency">
                <div>–ö–†–ò–°–¢–ê–õ–õ–´</div>
                <div id="crystals-display" class="currency-value">0</div>
            </div>
        </div>
        
        <div id="click-area">
            <button id="click-button"></button>
            <div class="cps-display">–ö–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É: <span id="cps-value">0</span></div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="generators">–ì–ï–ù–ï–†–ê–¢–û–†–´</div>
            <div class="tab" data-tab="upgrades">–£–õ–£–ß–®–ï–ù–ò–Ø</div>
            <div class="tab" data-tab="prestige">–ü–†–ï–°–¢–ò–ñ</div>
        </div>
        
        <div id="generators" class="tab-content active">
            <!-- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <div id="upgrades" class="tab-content">
            <!-- –£–ª—É—á—à–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <div id="prestige" class="tab-content">
            <div class="pixel-border">
                <h3>–°–ò–°–¢–ï–ú–ê –ü–†–ï–°–¢–ò–ñ–ê</h3>
                <p>–¢–µ–∫—É—â–∏–π –±–æ–Ω—É—Å: <span id="prestige-bonus">0%</span></p>
                <p>–ö—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –∑–∞ –ø—Ä–µ—Å—Ç–∏–∂: <span id="prestige-crystals">0</span></p>
                <button id="prestige-button" disabled>–ü–†–ï–°–¢–ò–ñ (—Ç—Ä–µ–±—É–µ—Ç—Å—è 1,000,000 –∫–ª–∏–∫–æ–≤)</button>
                <p><small>–ü—Ä–∏ –ø—Ä–µ—Å—Ç–∏–∂–µ –≤—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –≤—Å–µ –∫–ª–∏–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è, –Ω–æ –ø–æ–ª—É—á–∏—Ç–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤</small></p>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.hide();
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            clicks: 0,
            crystals: 0,
            prestige: 0,
            cps: 0,
            generators: [
                { id: 1, name: "–ü–æ–º–æ—â–Ω–∏–∫", level: 0, baseCPS: 0.1, baseCost: 15, icon: "üë®‚Äçüíº" },
                { id: 2, name: "–§–µ—Ä–º–∞", level: 0, baseCPS: 0.5, baseCost: 100, icon: "üåæ" },
                { id: 3, name: "–§–∞–±—Ä–∏–∫–∞", level: 0, baseCPS: 2, baseCost: 500, icon: "üè≠" },
                { id: 4, name: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è", level: 0, baseCPS: 10, baseCost: 3000, icon: "üî¨" },
                { id: 5, name: "–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä", level: 0, baseCPS: 50, baseCost: 20000, icon: "üíª" }
            ],
            upgrades: [
                { id: 1, name: "–£–ª—É—á—à–µ–Ω–Ω—ã–π –∫—É—Ä—Å–æ—Ä", description: "+0.1 –∫–ª–∏–∫–∞ –∑–∞ –∫–ª–∏–∫", level: 0, maxLevel: 10, baseCost: 100, effect: 0.1, type: "click" },
                { id: 2, name: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä", description: "+0.01 –ö–í–° –≤—Å–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞–º", level: 0, maxLevel: 5, baseCost: 500, effect: 0.01, type: "cps" },
                { id: 3, name: "–ó–æ–ª–æ—Ç–∞—è —Ä—É–∫–∞", description: "–®–∞–Ω—Å 5% –Ω–∞ –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫", level: 0, maxLevel: 3, baseCost: 2000, effect: 5, type: "critical" }
            ],
            clickPower: 1,
            criticalChance: 0
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadGame();
            renderGame();
            setupEventListeners();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤
            setInterval(() => {
                gameState.clicks += gameState.cps / 10;
                updateDisplays();
                saveGame();
            }, 100);
        }
        
        // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
        function getGeneratorCost(generator) {
            return Math.floor(generator.baseCost * Math.pow(1.15, generator.level));
        }
        
        // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è
        function getUpgradeCost(upgrade) {
            return Math.floor(upgrade.baseCost * Math.pow(2, upgrade.level));
        }
        
        // –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ CPS
        function calculateCPS() {
            let totalCPS = 0;
            
            // CPS –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤
            gameState.generators.forEach(generator => {
                totalCPS += generator.level * generator.baseCPS * (1 + gameState.upgrades[1].level * gameState.upgrades[1].effect);
            });
            
            return totalCPS;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function renderGame() {
            updateDisplays();
            renderGenerators();
            renderUpgrades();
            renderPrestige();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        function updateDisplays() {
            gameState.cps = calculateCPS();
            
            document.getElementById('clicks-display').textContent = formatNumber(gameState.clicks);
            document.getElementById('crystals-display').textContent = gameState.crystals;
            document.getElementById('cps-value').textContent = formatNumber(gameState.cps);
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return Math.floor(num);
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤
        function renderGenerators() {
            const container = document.getElementById('generators');
            container.innerHTML = '';
            
            gameState.generators.forEach(generator => {
                const cost = getGeneratorCost(generator);
                const generatorElement = document.createElement('div');
                generatorElement.className = 'generator';
                generatorElement.innerHTML = `
                    <div class="generator-icon">${generator.icon}</div>
                    <div class="generator-info">
                        <div class="generator-name">${generator.name} [${generator.level}]</div>
                        <div class="generator-cps">${generator.baseCPS * generator.level} –ö–í–°</div>
                    </div>
                    <div class="generator-cost">${formatNumber(cost)}</div>
                `;
                
                generatorElement.addEventListener('click', () => buyGenerator(generator.id));
                if (gameState.clicks < cost) generatorElement.style.opacity = '0.5';
                
                container.appendChild(generatorElement);
            });
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π
        function renderUpgrades() {
            const container = document.getElementById('upgrades');
            container.innerHTML = '';
            
            gameState.upgrades.forEach(upgrade => {
                const cost = getUpgradeCost(upgrade);
                const upgradeElement = document.createElement('div');
                upgradeElement.className = 'upgrade';
                
                let levelInfo = '';
                if (upgrade.maxLevel > 1) {
                    levelInfo = `<div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å ${upgrade.level}/${upgrade.maxLevel}</div>`;
                }
                
                upgradeElement.innerHTML = `
                    <div class="upgrade-info">
                        <strong>${upgrade.name}</strong>
                        <div>${upgrade.description}</div>
                        ${levelInfo}
                    </div>
                    <div class="upgrade-price">${formatNumber(cost)}</div>
                `;
                
                if (upgrade.level < upgrade.maxLevel && gameState.clicks >= cost) {
                    upgradeElement.addEventListener('click', () => buyUpgrade(upgrade.id));
                } else {
                    upgradeElement.style.opacity = '0.5';
                }
                
                container.appendChild(upgradeElement);
            });
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ø—Ä–µ—Å—Ç–∏–∂–∞
        function renderPrestige() {
            const crystals = Math.floor(Math.sqrt(gameState.clicks / 100000));
            document.getElementById('prestige-crystals').textContent = crystals;
            document.getElementById('prestige-bonus').textContent = `${gameState.prestige * 5}%`;
            
            const prestigeButton = document.getElementById('prestige-button');
            prestigeButton.disabled = gameState.clicks < 1000000;
            
            if (!prestigeButton.onclick) {
                prestigeButton.addEventListener('click', doPrestige);
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
        function buyGenerator(id) {
            const generator = gameState.generators.find(g => g.id === id);
            const cost = getGeneratorCost(generator);
            
            if (gameState.clicks >= cost) {
                gameState.clicks -= cost;
                generator.level++;
                renderGame();
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
        function buyUpgrade(id) {
            const upgrade = gameState.upgrades.find(u => u.id === id);
            const cost = getUpgradeCost(upgrade);
            
            if (gameState.clicks >= cost && upgrade.level < upgrade.maxLevel) {
                gameState.clicks -= cost;
                upgrade.level++;
                
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞
                if (upgrade.type === "click") {
                    gameState.clickPower += upgrade.effect;
                } else if (upgrade.type === "critical") {
                    gameState.criticalChance += upgrade.effect;
                }
                
                renderGame();
            }
        }
        
        // –ü—Ä–µ—Å—Ç–∏–∂
        function doPrestige() {
            if (gameState.clicks < 1000000) return;
            
            const crystals = Math.floor(Math.sqrt(gameState.clicks / 100000));
            gameState.crystals += crystals;
            gameState.prestige++;
            
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
            gameState.clicks = 0;
            gameState.generators.forEach(g => g.level = 0);
            gameState.upgrades.forEach(u => u.level = 0);
            gameState.clickPower = 1;
            gameState.criticalChance = 0;
            
            renderGame();
            saveGame();
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–ª–∏–∫ –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–Ω–æ–ø–∫–µ
            document.getElementById('click-button').addEventListener('click', () => {
                let clickValue = gameState.clickPower;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫
                if (Math.random() * 100 < gameState.criticalChance) {
                    clickValue *= 2;
                    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
                }
                
                gameState.clicks += clickValue;
                updateDisplays();
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            localStorage.setItem('pixelClickerSave', JSON.stringify(gameState));
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã
        function loadGame() {
            const saved = localStorage.getItem('pixelClickerSave');
            if (saved) {
                gameState = JSON.parse(saved);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
    </script>
</body>
</html>
